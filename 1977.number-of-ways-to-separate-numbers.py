#
# @lc app=leetcode.cn id=1977 lang=python3
# @lcpr version=30204
#
# [1977] 划分数字的方案数
#


# @lcpr-template-start


# @lcpr-template-end
# @lc code=start
class Solution:
    def numberOfCombinations(self, num: str) -> int:
        if num[0] == "0":
            return 0
        N = len(num)

        lcp=[[0]*(N+1) for _ in range(N+1)]

        for i in range(N-1,-1,-1):
            for j in range(N-1,-1,-1):
                if num[i]==num[j]:
                    lcp[i][j]=lcp[i+1][j+1]+1

        def less_equal(l1,l2,r2):
            l=lcp[l1][l2]
            return l>=r2-l2 or num[l1+l]<num[l2+l]

        Mods = 10**9 + 7
        # f[i][j]
        # num 前j个字符
        # 最后一个整数的起始位置i
        f = [[0] * N for _ in range(N)]

        f[0]=[1]*N       
        
        for i in range(1,N):
            if num[i]=='0':
                continue
            k,s=i-1,0
            for j in range(i,N):
                f[i][j]=s
                if k<0:
                    continue
                if num[k]!='0' and less_equal(k,i,j+1):
                    f[i][j]=(f[i][j]+f[k][i-1])%Mods
                s=(s+f[k][i-1])%Mods
                k-=1
        return sum([row[-1] for row in f])%Mods


# @lc code=end
# assert Solution().numberOfCombinations("11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111") == 755568658
assert Solution().numberOfCombinations("9999999999999") == 101
assert Solution().numberOfCombinations("4321") == 2
assert Solution().numberOfCombinations("0") == 0
assert Solution().numberOfCombinations("094") == 0
assert Solution().numberOfCombinations("327") == 2


#
# @lcpr case=start
# "327"\n
# @lcpr case=end

# @lcpr case=start
# "094"\n
# @lcpr case=end

# @lcpr case=start
# "0"\n
# @lcpr case=end

# @lcpr case=start
# "9999999999999"\n
# @lcpr case=end

#
