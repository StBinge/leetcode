#
# @lc app=leetcode.cn id=LCP 33 lang=python3
# @lcpr version=30204
#
# [LCP 33] 蓄水
#

from sbw import *
# @lcpr-template-start

# @lcpr-template-end
# @lc code=start
class Solution:
    def storeWater(self, bucket: List[int], vat: List[int]) -> int:
        heap=[]
        cnt=0
        for i in range(len(bucket)):
            if vat[i]==0:
                continue
            if bucket[i]==0:
                bucket[i]=1
                cnt+=1
            heapq.heappush(heap,[-((vat[i]-1)//bucket[i]+1),i])
        if not heap:
            return 0
        ret=float('inf')
        while cnt<ret:
            v,i=heapq.heappop(heap)
            v=-v
            ret=min(ret,v+cnt)
            if v==1:
                break
            v-=1
            b=(vat[i]-1)//v + 1
            cnt+=b-bucket[i]
            bucket[i]=b
            heapq.heappush(heap,[-v,i])
        return ret

# @lc code=end
assert Solution().storeWater([6946,1211,4548,1685,4842,7665,4215,8583,347,2050,6739,9363,2302,3913,8829,1848,7619,5816,7003,2717,4354,5517,6810,3917,9400,7767,7687,66,4736,8092,2960,9985,3026,7557,2442,4417,8319,1933,9530,6214,326,490,4446,8179,4315,6762,3839,3370,9486,5018,5369,539,4826,8359,7663,6714,2621,5871,368,47,50,4574,4918,7023,5749,1937,5341,3557,9993,6702,8461,438,6757,1505,9815,2354,3427,603,7149,8148,9861,2228,2168,7176,4916,3958,5517,3648,2210,242,2132,2649,5840,6060,4556,1978,37,559,2301,2111],[7807,8501,9509,9424,8131,9529,9733,9396,5226,4789,9403,9943,3788,6090,9632,2497,9985,8748,7159,4995,9933,9088,8958,9161,9642,9460,9843,483,7040,8952,6202,9985,6267,8794,3895,5877,9463,4491,9617,9951,2944,3900,5882,8660,6613,8709,9848,3953,9594,9519,8015,7571,7032,8963,8856,6823,9423,8557,6895,8632,9690,5980,6376,8718,9525,8943,7750,9670,9997,8983,9386,1649,8236,2276,9958,3273,9614,4692,8065,8726,9935,7931,6915,9930,5931,5502,6875,7322,3549,5460,6831,3641,9404,8929,7623,2230,4168,8526,5111,3014])==174
assert Solution().storeWater([9988,5017,5130,2445,9896,9151,3625,7801,608,3283,1386,979,5209,4182,8234,9870,8714,6435,3800,956,4006,5620,7474,1205,6993,3320,1201,7593,905,3816,4522,4560,8027,8219,6686,3779,2141,1240,6504,6612,6921,7329,8145,5745,7652,4340,7933,6246,5157,9447,107,9665,3653,2978,9832,4945,4312,2199,449,8432,3230,8163,800,6547,1110,1194,9384,632,3275,1229,7230,8643,7613,8256,5043,1288,3088,8997,4554,4755,7433,8146,9722,3469,8863,5831,7816,5058,4316,7946,8402,975,2450,4958,9811,9336,21,9309,8999,56],[9991,6973,7192,9876,9910,9549,3700,8814,1308,9981,9234,7292,7732,8458,8441,9939,9621,7285,7452,2718,6589,7555,8788,3202,7832,4781,8798,9299,2112,9963,8755,7240,9217,8587,6782,9703,8954,3759,6907,7218,7333,8020,8323,5750,9510,8571,8664,8510,9363,9741,8643,9825,4227,8530,9961,8511,8949,7486,9086,9690,5316,9581,9314,8817,7234,8998,9485,5394,7365,1501,7984,9802,9778,8314,7482,7117,5117,9609,8732,9728,9330,8800,9775,6210,8966,7700,8802,7607,8950,9730,9855,1231,5228,5329,9982,9532,3230,9951,9034,8299])==138
assert Solution().storeWater(bucket = [9,0,1], vat = [0,2,2])==3
assert Solution().storeWater(bucket = [1,3], vat = [6,8])==4
assert Solution().storeWater([0],[0])==0
assert Solution().storeWater([3,2,5],[0,0,0])==0


#
# @lcpr case=start
# [1,3]\n[6,8]`>\n
# @lcpr case=end

# @lcpr case=start
# [9,0,1]\n[0,2,2]`>\n
# @lcpr case=end

#

